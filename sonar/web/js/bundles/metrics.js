webpackJsonp([15],{0:function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}var a=n(354),s=i(a),o=n(379),l=i(o),r=n(1275),d=i(r),c=n(951),u=i(c),f=n(1277),p=i(f),m=n(1282),h=i(m),v=n(1288),y=i(v),b=new l["default"].Application,w=function(){var e=window.sonarqube;this.layout=new d["default"]({el:e.el}),this.layout.render(),this.metrics=new u["default"],this.headerView=new p["default"]({collection:this.metrics,domains:this.domains,types:this.types,app:b}),this.layout.headerRegion.show(this.headerView),this.listView=new h["default"]({collection:this.metrics,domains:this.domains,types:this.types}),this.layout.listRegion.show(this.listView),this.listFooterView=new y["default"]({collection:this.metrics}),this.layout.listFooterRegion.show(this.listFooterView),this.metrics.fetch()};b.requestDomains=function(){return s["default"].get(window.baseUrl+"/api/metrics/domains").done(function(e){b.domains=e.domains})},b.requestTypes=function(){return s["default"].get(window.baseUrl+"/api/metrics/types").done(function(e){b.types=e.types})},b.on("start",function(){s["default"].when(b.requestDomains(),b.requestTypes()).done(function(){w.call(b)})}),window.sonarqube.appStarted.then(function(e){return b.start(e)})},402:function(e,t){"use strict";e.exports=function(){var e=Array.prototype.slice.call(arguments,0,-1);return window.t.apply(this,e)}},459:function(e,t){"use strict";e.exports=function(e,t,n){return e==t?n.fn(this):n.inverse(this)}},482:function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var a=n(354),s=i(a),o=n(379),l=i(o),r="modal";t["default"]=l["default"].ItemView.extend({className:"modal",overlayClassName:"modal-overlay",htmlClassName:"modal-open",events:function(){return{"click .js-modal-close":"onCloseClick"}},onRender:function(){var e=this;this.$el.detach().appendTo((0,s["default"])("body")),(0,s["default"])("html").addClass(this.htmlClassName),this.renderOverlay(),this.keyScope=key.getScope(),key.setScope("modal"),key("escape","modal",function(){return e.destroy(),!1}),this.show(),this.options.large&&this.$el.addClass("modal-large")},show:function(){var e=this;setTimeout(function(){e.$el.addClass("in"),(0,s["default"])("."+e.overlayClassName).addClass("in")},0)},onDestroy:function(){(0,s["default"])("html").removeClass(this.htmlClassName),this.removeOverlay(),key.deleteScope("modal"),key.setScope(this.keyScope)},onCloseClick:function(e){e.preventDefault(),this.destroy()},renderOverlay:function(){var e=(0,s["default"])("."+this.overlayClassName);0===e.length&&(0,s["default"])('<div class="'+this.overlayClassName+'"></div>').appendTo((0,s["default"])("body"))},removeOverlay:function(){(0,s["default"])("."+this.overlayClassName).remove()},attachCloseEvents:function(){var e=this;(0,s["default"])("body").on("click."+r,function(){(0,s["default"])("body").off("click."+r),e.destroy()})}})},782:function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var a=n(328),s=i(a),o=n(482),l=i(o);t["default"]=l["default"].extend({ui:function(){return{messagesContainer:".js-modal-messages"}},events:function(){return s["default"].extend(l["default"].prototype.events.apply(this,arguments),{"keydown input,textarea,select":"onInputKeydown","submit form":"onFormSubmit"})},onRender:function(){l["default"].prototype.onRender.apply(this,arguments);var e=this;setTimeout(function(){e.$(":tabbable").first().focus()},0)},onInputKeydown:function(e){27===e.keyCode&&this.destroy()},onFormSubmit:function(e){e.preventDefault()},showErrors:function(e,t){var n=this.ui.messagesContainer.empty();s["default"].isArray(e)&&e.forEach(function(e){var t='<div class="alert alert-danger">'+e.msg+"</div>";n.append(t)}),s["default"].isArray(t)&&t.forEach(function(e){var t='<div class="alert alert-warning">'+e.msg+"</div>";n.append(t)}),this.ui.messagesContainer.scrollParent().scrollTop(0)},disableForm:function(){var e=this.$("form");this.disabledFields=e.find(":input:not(:disabled)"),this.disabledFields.prop("disabled",!0)},enableForm:function(){null!=this.disabledFields&&this.disabledFields.prop("disabled",!1)}})},951:function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var a=n(328),s=i(a),o=n(376),l=i(o),r=n(952),d=i(r);t["default"]=l["default"].Collection.extend({model:d["default"],url:function(){return window.baseUrl+"/api/metrics/search"},parse:function(e){return this.total=e.total,this.p=e.p,this.ps=e.ps,e.metrics},fetch:function(e){var t=s["default"].defaults(e||{},{data:{}});return this.q=t.data.q,t.data.isCustom=!0,l["default"].Collection.prototype.fetch.call(this,t)},fetchMore:function(){var e=this.p+1;return this.fetch({add:!0,remove:!1,data:{p:e,ps:this.ps,q:this.q}})},refresh:function(){return this.fetch({reset:!0,data:{q:this.q}})},hasMore:function(){return this.total>this.p*this.ps}})},952:function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var a=n(328),s=i(a),o=n(376),l=i(o);t["default"]=l["default"].Model.extend({idAttribute:"id",urlRoot:function(){return window.baseUrl+"/api/metrics"},sync:function(e,t,n){var i=n||{};return"create"===e&&s["default"].defaults(i,{url:this.urlRoot()+"/create",type:"POST",data:s["default"].pick(t.toJSON(),"key","name","description","domain","type")}),"update"===e&&s["default"].defaults(i,{url:this.urlRoot()+"/update",type:"POST",data:s["default"].pick(t.toJSON(),"id","key","name","description","domain","type")}),"delete"===e&&s["default"].defaults(i,{url:this.urlRoot()+"/delete",type:"POST",data:{ids:this.id}}),l["default"].ajax(i)}})},1275:function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var a=n(379),s=i(a),o=n(1276),l=i(o);t["default"]=s["default"].LayoutView.extend({template:l["default"],regions:{headerRegion:"#metrics-header",listRegion:"#metrics-list",listFooterRegion:"#metrics-list-footer"}})},1276:function(e,t,n){var i=n(393);e.exports=(i["default"]||i).template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){return'<div class="page">\n  <div id="metrics-header"></div>\n  <div id="metrics-list"></div>\n  <div id="metrics-list-footer"></div>\n</div>\n'},useData:!0})},1277:function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var a=n(379),s=i(a),o=n(1278),l=i(o),r=n(1281),d=i(r);t["default"]=s["default"].ItemView.extend({template:d["default"],events:{"click #metrics-create":"onCreateClick"},onCreateClick:function(e){e.preventDefault(),this.createMetric()},createMetric:function(){new l["default"]({collection:this.collection,domains:this.options.domains,types:this.options.types,app:this.options.app}).render()}})},1278:function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var a=n(952),s=i(a),o=n(1279),l=i(o);t["default"]=l["default"].extend({sendRequest:function(){var e=this,t=new s["default"]({key:this.$("#create-metric-key").val(),name:this.$("#create-metric-name").val(),description:this.$("#create-metric-description").val(),domain:this.$("#create-metric-domain").val(),type:this.$("#create-metric-type").val()});return this.disableForm(),t.save(null,{statusCode:{400:null}}).done(function(){e.collection.refresh(),e.options.domains.indexOf(t.get("domain"))===-1&&e.options.domains.push(t.get("domain")),e.destroy()}).fail(function(t){e.showErrors(t.responseJSON.errors,t.responseJSON.warnings),e.enableForm()})}})},1279:function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var a=n(354),s=i(a),o=n(328),l=i(o),r=n(782),d=i(r),c=n(1280),u=i(c);t["default"]=d["default"].extend({template:u["default"],onRender:function(){var e=this;d["default"].prototype.onRender.apply(this,arguments),this.$('[data-toggle="tooltip"]').tooltip({container:"body",placement:"bottom"}),this.$("#create-metric-domain").select2({width:"250px",createSearchChoice:function(e){return{id:e,text:"+"+e}},createSearchChoicePosition:"top",initSelection:function(e,t){var n=(0,s["default"])(e).val();t({id:n,text:n})},query:function(t){var n=e.options.domains.filter(function(e){return e.toLowerCase().indexOf(t.term.toLowerCase())!==-1}),i=n.map(function(e){return{id:e,text:e}});t.callback({results:i,more:!1})}}).select2("val",this.model&&this.model.get("domain")),this.$("#create-metric-type").select2({width:"250px"})},onDestroy:function(){d["default"].prototype.onDestroy.apply(this,arguments),this.$('[data-toggle="tooltip"]').tooltip("destroy")},onFormSubmit:function(){d["default"].prototype.onFormSubmit.apply(this,arguments),this.sendRequest()},serializeData:function(){return l["default"].extend(d["default"].prototype.serializeData.apply(this,arguments),{domains:this.options.domains,types:this.options.types})}})},1280:function(e,t,n){var i=n(393);e.exports=(i["default"]||i).template({1:function(e,t,n,i){return"Update"},3:function(e,t,n,i){return"Create"},5:function(e,t,i,a,s){var o,l=this.lambda,r=this.escapeExpression,d='          <option value="'+r(l(e,e))+'" ';return o=n(459).call(e,e,null!=s[1]?s[1].type:s[1],{name:"eq",hash:{},fn:this.program(6,a,s),inverse:this.noop,data:a}),null!=o&&(d+=o),d+">"+r(n(402).call(e,"metric.type",e,{name:"t",hash:{},data:a}))+"</option>\n"},6:function(e,t,n,i){return"selected"},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i,a){var s,o=this.lambda,l=this.escapeExpression,r='<form id="create-metric-form" autocomplete="off">\n  <div class="modal-head">\n    <h2>';return s=t["if"].call(e,null!=e?e.id:e,{name:"if",hash:{},fn:this.program(1,i,a),inverse:this.program(3,i,a),data:i}),null!=s&&(r+=s),r+=' Metric</h2>\n  </div>\n  <div class="modal-body">\n    <div class="js-modal-messages"></div>\n    <div class="modal-field">\n      <label for="create-metric-key">Key<em class="mandatory">*</em></label>\n      <input id="create-metric-key" name="key" type="text" maxlength="200" required value="'+l(o(null!=e?e.key:e,e))+'">\n    </div>\n    <div class="modal-field">\n      <label for="create-metric-name">Name<em class="mandatory">*</em></label>\n      <input id="create-metric-name" name="name" type="text" maxlength="200" required value="'+l(o(null!=e?e.name:e,e))+'">\n    </div>\n    <div class="modal-field">\n      <label for="create-metric-description">Description</label>\n      <textarea id="create-metric-description" name="description">'+l(o(null!=e?e.description:e,e))+'</textarea>\n    </div>\n    <div class="modal-field">\n      <label for="create-metric-domain">Domain</label>\n      <input id="create-metric-domain" name="domain" type="text" maxlength="200" value="'+l(o(null!=e?e.domain:e,e))+'">\n    </div>\n    <div class="modal-field">\n      <label for="create-metric-type">Type<em class="mandatory">*</em></label>\n      <select id="create-metric-type" name="type">\n',s=t.each.call(e,null!=e?e.types:e,{name:"each",hash:{},fn:this.program(5,i,a),inverse:this.noop,data:i}),null!=s&&(r+=s),r+='      </select>\n    </div>\n  </div>\n  <div class="modal-foot">\n    <button id="create-metric-submit">',s=t["if"].call(e,null!=e?e.id:e,{name:"if",hash:{},fn:this.program(1,i,a),inverse:this.program(3,i,a),data:i}),null!=s&&(r+=s),r+'</button>\n    <a href="#" class="js-modal-close" id="create-metric-cancel">Cancel</a>\n  </div>\n</form>\n'},useData:!0,useDepths:!0})},1281:function(e,t,n){var i=n(393);e.exports=(i["default"]||i).template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){return'<header class="page-header">\n  <h1 class="page-title">Custom Metrics</h1>\n  <div class="page-actions">\n    <div class="button-group">\n      <button id="metrics-create">Create Metric</button>\n    </div>\n  </div>\n  <p class="page-description">These metrics are available for all projects. Manual measures can be set at project level\n    via the configuration interface.</p>\n</header>\n'},useData:!0})},1282:function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var a=n(379),s=i(a),o=n(1283),l=i(o);t["default"]=s["default"].CollectionView.extend({tagName:"ul",childView:l["default"],childViewOptions:function(){return{types:this.options.types,domains:this.options.domains}}})},1283:function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var a=n(379),s=i(a),o=n(1284),l=i(o),r=n(1285),d=i(r),c=n(1287),u=i(c);t["default"]=s["default"].ItemView.extend({tagName:"li",className:"panel panel-vertical",template:u["default"],events:{"click .js-metric-update":"onUpdateClick","click .js-metric-delete":"onDeleteClick"},onRender:function(){this.$el.attr("data-id",this.model.id).attr("data-key",this.model.get("key")),this.$('[data-toggle="tooltip"]').tooltip({container:"body",placement:"bottom"})},onDestroy:function(){this.$('[data-toggle="tooltip"]').tooltip("destroy")},onUpdateClick:function(e){e.preventDefault(),this.updateMetric()},onDeleteClick:function(e){e.preventDefault(),this.deleteMetric()},updateMetric:function(){new l["default"]({model:this.model,collection:this.model.collection,types:this.options.types,domains:this.options.domains}).render()},deleteMetric:function(){new d["default"]({model:this.model}).render()}})},1284:function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var a=n(1279),s=i(a);t["default"]=s["default"].extend({sendRequest:function(){var e=this;return this.model.set({key:this.$("#create-metric-key").val(),name:this.$("#create-metric-name").val(),description:this.$("#create-metric-description").val(),domain:this.$("#create-metric-domain").val(),type:this.$("#create-metric-type").val()}),this.disableForm(),this.model.save(null,{statusCode:{400:null}}).done(function(){e.collection.refresh(),e.destroy()}).fail(function(t){e.enableForm(),e.showErrors(t.responseJSON.errors,t.responseJSON.warnings)})}})},1285:function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var a=n(782),s=i(a),o=n(1286),l=i(o);t["default"]=s["default"].extend({template:l["default"],onFormSubmit:function(){s["default"].prototype.onFormSubmit.apply(this,arguments),this.sendRequest()},sendRequest:function(){var e=this,t=this.model.collection;return this.model.destroy({wait:!0,statusCode:{400:null}}).done(function(){t.refresh(),e.destroy()}).fail(function(t){e.showErrors(t.responseJSON.errors,t.responseJSON.warnings)})}})},1286:function(e,t,n){var i=n(393);e.exports=(i["default"]||i).template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a,s="function",o=t.helperMissing,l=this.escapeExpression;return'<form id="delete-metric-form">\n  <div class="modal-head">\n    <h2>Delete Metric</h2>\n  </div>\n  <div class="modal-body">\n    <div class="js-modal-messages"></div>\n    Are you sure you want to delete metric "'+l((a=null!=(a=t.name||(null!=e?e.name:e))?a:o,typeof a===s?a.call(e,{name:"name",hash:{},data:i}):a))+'"?\n  </div>\n  <div class="modal-foot">\n    <button id="delete-metric-submit" class="button-red">Delete</button>\n    <a href="#" class="js-modal-close" id="delete-metric-cancel">Cancel</a>\n  </div>\n</form>\n'},useData:!0})},1287:function(e,t,n){var i=n(393);e.exports=(i["default"]||i).template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,i,a){var s=this.lambda,o=this.escapeExpression;return'<div class="pull-right big-spacer-left nowrap">\n  <a class="js-metric-update icon-edit" title="Update" data-toggle="tooltip" href="#"></a>\n  <a class="js-metric-delete icon-delete" title="Delete" data-toggle="tooltip" href="#"></a>\n</div>\n\n<div class="display-inline-block text-top width-30">\n  <div>\n    <strong class="js-metric-name">'+o(s(null!=e?e.name:e,e))+'</strong>\n    <span class="js-metric-key note little-spacer-left">'+o(s(null!=e?e.key:e,e))+'</span>\n  </div>\n</div>\n\n<div class="display-inline-block text-top width-20">\n  <span class="js-metric-domain">'+o(s(null!=e?e.domain:e,e))+'</span>\n</div>\n\n<div class="display-inline-block text-top width-20">\n  <span class="js-metric-type">'+o(n(402).call(e,"metric.type",null!=e?e.type:e,{name:"t",hash:{},data:a}))+'</span>\n</div>\n\n<div class="display-inline-block text-top width-20">\n  <span class="js-metric-description">'+o(s(null!=e?e.description:e,e))+"</span>\n</div>\n"},useData:!0})},1288:function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var a=n(328),s=i(a),o=n(379),l=i(o),r=n(1289),d=i(r);t["default"]=l["default"].ItemView.extend({template:d["default"],collectionEvents:{all:"render"},events:{"click #metrics-fetch-more":"onMoreClick"},onMoreClick:function(e){e.preventDefault(),this.fetchMore()},fetchMore:function(){this.collection.fetchMore()},serializeData:function(){return s["default"].extend(l["default"].ItemView.prototype.serializeData.apply(this,arguments),{total:this.collection.total,count:this.collection.length,more:this.collection.hasMore()})}})},1289:function(e,t,n){var i=n(393);e.exports=(i["default"]||i).template({1:function(e,t,n,i){return'    <a id="metrics-fetch-more" class="spacer-left" href="#">show more</a>\n'},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a,s,o="function",l=t.helperMissing,r=this.escapeExpression,d='<footer class="spacer-top note text-center">\n  '+r((s=null!=(s=t.count||(null!=e?e.count:e))?s:l,typeof s===o?s.call(e,{name:"count",hash:{},data:i}):s))+"/"+r((s=null!=(s=t.total||(null!=e?e.total:e))?s:l,typeof s===o?s.call(e,{name:"total",hash:{},data:i}):s))+" shown\n";return a=t["if"].call(e,null!=e?e.more:e,{name:"if",hash:{},fn:this.program(1,i),inverse:this.noop,data:i}),null!=a&&(d+=a),d+"</footer>\n"},useData:!0})}});